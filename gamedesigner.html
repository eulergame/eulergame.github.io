

<!DOCTYPE html>
<html lang="en-us">
<head>
    <title>游戏策划</title>
    <meta charset="utf-8" />
    <meta name="description" content="游戏策划 tutorials">
    <meta name="keywords" content="游戏策划">
    <meta name="author" content="LaoZhang">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css" />
    <script type="text/javascript" async
            src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
</head>
<body>
    <h1>技能</h1>
    <h2>技能基础配置</h2>
    <p>Skill.csv</p>
    <ul>
        <li>ID 技能id</li>
        <li>Hit 命中</li>
        <li>AttackPoint 攻击点数</li>
        <li>AttackPercentage 攻击百分比</li>
        <li>IgnoreDefensePoint 忽视防御</li>
        <li>IgnoreDefensePercentage 忽视防御百分比</li>
        <li>DamagePoint 附加伤害</li>
        <li>DamagePercentage 附加伤害百分比</li>
        <li>CriticalPoint 暴击</li>
        <li>Pierce 穿透</li>
        <li>PhysicsOrMagic 1物攻 2法攻</li>

    </ul>
    <h2>技能等级配置</h2>
    <p>SkillEffect.csv</p>
    <ul>
        <li>Level 等级</li>
        <li>AttackPoint 攻击点数</li>
        <li>AttackPercentage 攻击百分比</li>
        <li>IgnoreDefensePoint 忽视防御</li>
        <li>IgnoreDefensePercentage 忽视防御百分比</li>
        <li>DamagePoint 附加伤害</li>
        <li>DamagePercentage 附加伤害百分比</li>
        <li>BreakPoint 破甲</li>
        <li>CriticalPoint 暴击</li>
        <li>Hit 命中</li>
        <li>Pierce 穿透</li>
    </ul>

    <h1>伤害公式</h1>
    When \(a \ne 0\), there are two solutions to \(ax^2 + bx + c = 0\) and they are
    $$x = {-b \pm \sqrt{b^2-4ac} \over 2a}.$$

    <p>假设a打b</p>
    \[\text{let} \quad csMillionRev = 0.0001\]

    <p>命中</p>
    \[
    \text{let} \quad fHit = a.Hit - b.Dodge + Skill.Hit \times SkillEffect.Hit \times csMillionRev\\
    fHit=
    \begin{cases}
    fHit \times 0.1 + 95, & \quad fHit \gt -100\\
    fHit \times 0.06 + 85, & \quad fHit \gt -300\\
    fHit \times 0.01 + 73,& \quad \text{others}\\
    \end{cases}
    \\
    fHit = \max(fHit, 60)\\
    fHit = \min(fHit, 100)\\
    \]

    <p>闪避</p>
    \[\text{if} \quad random(0, 100) > fHit, \text{闪避成功，无伤害}\]

    <p>技能攻击</p>
    \[
    \text{let} \quad a1=
    \begin{cases}
    a.PhysicsAttack, & \quad Skill.PhysicsOrMagic == Physics\\
    a.MagicAttack, & \quad \text{others}
    \end{cases}\\

    \text{let} \quad A = (a1 + Skill.AttackPoint \times SkillEffect.AttackPoint \times csMillionRev) \times (1 + Skill.AttackPercentage \times SkillEffect.AttackPercentage \times csMillionRev^2)\\
    \]

    <p>目标防御</p>
    \[
    \text{let} \quad b1=
    \begin{cases}
    b.PhysicsDefense, & \quad Skill.PhysicsOrMagic == Physics\\
    b.MagicDefense, & \quad \text{others}
    \end{cases}\\

    \text{let} \quad B = b1 \times (1 - Skill.IgnoreDefensePercentage \times SkillEffect.IgnoreDefensePercentage \times csMillionRev)
    - Skill.IgnoreDefensePoint \times SkillEffect.IgnoreDefensePoint \times csMillionRev\\

    B = \max(0, B)
    \]

    <p>附加伤害百分比</p>
    \[
    \text{let} \quad y5=
    \begin{cases}
    \frac{Skill.DamagePercentage \times SkillEffect.DamagePercentage}{csMillionRev^2} , & \quad Skill.DamagePercentage \gt 0\\
    (Skill.DamagePercentage + SkillEffect.DamagePercentage) \times  csMillionRev, & \quad \text{others}
    \end{cases}\\

    \text{let} \quad C = y5 + a.DamageAdd \times csMillionRev + y5\\

    C = \max(0, C)
    \]

    <p>附加伤害点数</p>
    \[
    \text{let} \quad D = Skill.DamagePoint \times SkillEffect.DamagePoint \times csMillionRev\\
    \]

    <p>暴击</p>
    \[
    \text{let} \quad S = a.CriticalStrike + Skill.CriticalPoint \times SkillEffect.CriticalPoint \times csMillionRev
    - b.CriticalStrike\\
    \text{let} \quad SRate=
    \begin{cases}
    0, & \quad S \le 0\\
    S \times 0.001 + 0.06, & \quad S \le 100\\
    (S - 100) \times 0.0004 + 0.16, & \quad S \le 300\\
    (S - 300) \times 0.0002 + 0.24, & \quad S \le 1000\\
    \min(0.5, (S - 1000) \times 0.0001 + 0.38, & \quad \text{others}
    \end{cases}\\
    \]

    <p>格挡</p>
    \[
    \text{let} \quad P = b.Parry - Skill.Pierce \times SkillEffect.Pierce \times csMillionRev - a.AntiParry\\
    \text{let} \quad PRate=
    \begin{cases}
    \max(0, P \times 0.0003 + 0.06), & \quad P \le 0\\
    P \times 0.0012 + 0.06, & \quad P \le 100\\
    (P - 100) \times 0.0004 + 0.18, & \quad P \le 300\\
    (P - 300) \times 0.0002 + 0.26, & \quad P \le 1000\\
    \min(0.5, (P - 1000) \times 0.0001 + 0.4, & \quad \text{others}
    \end{cases}\\
    \]

    <p>伤害</p>
    \[
    \\
    \text{let} \quad G=1 + \max(S,0) \times 0.0002\\
    G=\min(G, 2)
    \\
    \\

    \text{let} \quad K=
    \begin{cases}
    A \times 1.5 - B, & \quad A \ge B\\
    \frac{A^2}{A \times 1.7 + B \times 0.3},& \quad \text{others}\\
    \end{cases}
    \\

    K = \max(0, K)
    \\
    \\
    \text{let} \quad F=
    \begin{cases}
    K, & \quad K \lt 2000\\
    2000 + (K - 2000) \times 0.5,& \quad K \lt 15000\\
    8500 + (K - 15000) \times 0.45,& \quad K \lt 50000\\
    26500 + (K - 50000) \times 0.35,& \quad K \lt 10000\\
    44000 + (K - 100000) \times 0.2,& \quad \text{others}\\
    \end{cases}
    \\
    \text{let} \quad H = \max((F+D) \times E \times G, 1) + \lfloor A \times 0.005 \times E \rfloor
    \\
    \text{let} \quad nDamAdd2 =
    \begin{cases}
    a.PlayerDamangeAdd, & \quad \text{a is player}\\
    a.MonsterDamangeAdd,& \quad \text{others}
    \end{cases}
    \\
    \text{if} \quad nDamAdd2 \gt 0, H = H \times (1 + nDamAdd2 \times csMillionRev)
    \\
    H=\min(H, 10000000)
    \]

    <p>暴击、格挡，随机</p>
    <p>\(\text{if} \quad random(0,1) \lt srate + prate\)</p>
    \[
    H=
    \begin{cases}
    H \times 1.5, \quad \text{if} \quad random(0,srate + prate) \lt srate\\
    H \times 0.5, \quad \text{others}
    \end{cases}
    \]

    <p>如果B是玩家，A也是玩家，分段伤害</p>
    \[H=
    \begin{cases}
    H \times 0.9 + 10, & \quad \frac{H}{b.MaxHP} \lt 0.12\\
    b.MaxHP \times 0.08, & \quad \frac{H}{b.MaxHP} \lt 0.15\\
    b.MaxHP \times 0.1, & \quad \frac{H}{b.MaxHP} \lt 0.3\\
    b.MaxHP \times 0.17, & \quad \frac{H}{b.MaxHP} \lt 1\\
    b.MaxHP \times 0.4, & \quad \frac{H}{b.MaxHP} \lt 3\\
    b.MaxHP \times 0.9, & \quad \text{others}
    \end{cases}
    \]
    \[H = H \times \min(1.25, \max(1, \frac{a.Power}{b.Power})) \]

    <p>如果B是玩家，A是怪物，秒杀保护</p>
    \[H = \min(H, b.MaxHP \times 0.9 + 10) \]

    <p>伤害整体调低</p>
    \[H = H \times 0.35 \]

    <p>浮动伤害</p>
    \[H = H \times random(0.9,1.1) \]

    <p>如果受击方B是怪物，可以设置伤害上限</p>
    \[H = \min(H,b.MaxHP \times monster.maxsinglehitdamange \times 0.0001) \]

    <p>最终伤害数值</p>
    \[H = \max(1,H) \]

    <h1>战力</h1>
    Power
    <h1>生命</h1>
    HP

    <h1>开服关服</h1>
    <p>开服   Bin/Cluster/开服.bat</p>
    <p>关服   Bin/Cluster/关服.bat</p>
    <p class="explain">
        * AgentServer是网关服，客户端通过tcp与之通信；DBServer是数据服，负责缓存数据，与数据库交互；SceneServer场景服，游戏的业务逻辑都在这里。CenterServer是中心服，负责服务器之间的消息中转。
    </p>


    <h1>导航网格</h1>
    <p>美术制作Unity场景test.unity</p>
    <p>依据场景地表，用插件(NavMesh Exension)构建TerrainMesh</p>
    <p class="explain">
        * 美术制作的场景地表，与策划期望的寻路地表是有差异的，所以用该插件来构建更合理的TerrainMesh
    </p>

    <p>在插件(NavMesh Exension) Bake NavMesh，会生成该场景的导航文件test/NavMesh.asset</p>
    <p class="explain">
        * 根据该TerrainMesh，生成Unity的导航网格，用于引擎寻路
    </p>

    <p>点击Unity菜单->Zen->同步导航网格文件到服务器</p>
    <p class="explain">
        * 怪物AI的寻路，需要在服务器完成，根据Untiy的NavMesh生成tiles，用于服务器A*寻路（todo 服务器也需要改成NavMesh寻路）
    </p>

    <p>该场景的导航网格制作流程完毕，重启服务器，测试完毕后可提交svn</p>

    <p class="explain">
        * 先根据策划构建的TerrainMesh拾取顶点A，再NavMesh.SamplePosition将A变换到Navmesh上的顶点B，B就是Navigation
        的Destination
    </p>



    <h1>怪物</h1>
    <h1>AI</h1>

    <h1>美术制作规范</h1>
    <h2>3DMax</h2>
    <p>system unit metric -> meters，基本长度单位是米，例如角色身高两米</p>
    <p>骨骼动画的骨头(bone)尽可能的少</p>


    <h2>角色</h2>
    <p>纹理尺寸：512x512</p>
    <h2>怪物</h2>
    <h2>NPC</h2>
    <h2>坐骑</h2>
    <h2>UI</h2>
    <h2>场景</h2>
    <h2>ICON</h2>
    <h2>宣传图</h2>
    <h2>特效</h2>
    <footer>
        <address>
            written by LaoZhang.<br />
            297191409@qq.com.<br />
            ShenZhen<br />
            China
        </address>
    </footer>

</body>
</html>
